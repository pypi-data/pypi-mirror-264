import{m as re,V as U}from"./VTextField-b7863fc2.js";import{s as Y,w as K,p as Z,aK as ce,aA as de,g as fe,aL as ve,r as L,h as $,c as b,aW as me,l as s,F as O,n as x,aY as pe,R as he,aZ as ye,q as ge,a_ as j}from"./index-3053b8a0.js";import{j as Ve,c as we,V as ke}from"./VCheckboxBtn-1d21707b.js";import{I as be,i as Ce,n as W,j as Pe,F as xe}from"./forwardRefs-0f883695.js";import{l as Se,k as Te,n as De,e as Ae,b as Ie,V as z,d as Fe}from"./VMenu-c1b42799.js";import{V as Re}from"./VVirtualScroll-bc1f8e5c.js";function Le(e,B){const l=Y(!1);let h;function v(i){cancelAnimationFrame(h),l.value=!0,h=requestAnimationFrame(()=>{h=requestAnimationFrame(()=>{l.value=!1})})}async function D(){await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>{if(l.value){const a=K(l,()=>{a(),i()})}else i()})}async function A(i){var I,F;if(i.key==="Tab"&&((I=B.value)==null||I.focus()),!["PageDown","PageUp","Home","End"].includes(i.key))return;const a=(F=e.value)==null?void 0:F.$el;if(!a)return;(i.key==="Home"||i.key==="End")&&a.scrollTo({top:i.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await D();const y=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(i.key==="PageDown"||i.key==="Home"){const o=a.getBoundingClientRect().top;for(const g of y)if(g.getBoundingClientRect().top>=o){g.focus();break}}else{const o=a.getBoundingClientRect().bottom;for(const g of[...y].reverse())if(g.getBoundingClientRect().bottom<=o){g.focus();break}}}return{onListScroll:v,onListKeydown:A}}const Be=Z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:ce,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...Se({itemChildren:!1})},"Select"),_e=Z({...Be(),...de(re({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...be({transition:{component:Te}})},"VSelect"),Ne=fe()({name:"VSelect",props:_e(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,B){let{slots:l}=B;const{t:h}=ve(),v=L(),D=L(),A=L(),i=$(e,"menu"),a=b({get:()=>i.value,set:t=>{var n;i.value&&!t&&((n=D.value)!=null&&n.Î¨openChildren)||(i.value=t)}}),{items:y,transformIn:I,transformOut:F}=De(e),o=$(e,"modelValue",[],t=>I(t===null?[null]:ye(t)),t=>{const n=F(t);return e.multiple?n:n[0]??null}),g=b(()=>typeof e.counterValue=="function"?e.counterValue(o.value):typeof e.counterValue=="number"?e.counterValue:o.value.length),C=Ve(),G=b(()=>o.value.map(t=>t.value)),V=Y(!1),E=b(()=>a.value?e.closeText:e.openText);let _="",H;const S=b(()=>e.hideSelected?y.value.filter(t=>!o.value.some(n=>n===t)):y.value),M=b(()=>e.hideNoData&&!S.value.length||e.readonly||(C==null?void 0:C.isReadonly.value)),J=b(()=>{var t;return{...e.menuProps,activatorProps:{...((t=e.menuProps)==null?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),T=L(),{onListScroll:Q,onListKeydown:X}=Le(T,v);function ee(t){e.openOnClear&&(a.value=!0)}function te(){M.value||(a.value=!a.value)}function le(t){var u,f;if(!t.key||e.readonly||C!=null&&C.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(a.value=!0),["Escape","Tab"].includes(t.key)&&(a.value=!1),t.key==="Home"?(u=T.value)==null||u.focus("first"):t.key==="End"&&((f=T.value)==null||f.focus("last"));const n=1e3;function c(r){const p=r.key.length===1,d=!r.ctrlKey&&!r.metaKey&&!r.altKey;return p&&d}if(e.multiple||!c(t))return;const w=performance.now();w-H>n&&(_=""),_+=t.key.toLowerCase(),H=w;const m=y.value.find(r=>r.title.toLowerCase().startsWith(_));m!==void 0&&(o.value=[m])}function R(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!t.props.disabled)if(e.multiple){const c=o.value.findIndex(m=>e.valueComparator(m.value,t.value)),w=n??!~c;if(~c){const m=w?[...o.value,t]:[...o.value];m.splice(c,1),o.value=m}else w&&(o.value=[...o.value,t])}else{const c=n!==!1;o.value=c?[t]:[],ge(()=>{a.value=!1})}}function ne(t){var n;(n=T.value)!=null&&n.$el.contains(t.relatedTarget)||(a.value=!1)}function ae(){var t;V.value&&((t=v.value)==null||t.focus())}function oe(t){V.value=!0}function ue(t){if(t==null)o.value=[];else if(j(v.value,":autofill")||j(v.value,":-webkit-autofill")){const n=y.value.find(c=>c.title===t);n&&R(n)}else v.value&&(v.value.value="")}return K(a,()=>{if(!e.hideSelected&&a.value&&o.value.length){const t=S.value.findIndex(n=>o.value.some(c=>e.valueComparator(c.value,n.value)));me&&window.requestAnimationFrame(()=>{var n;t>=0&&((n=A.value)==null||n.scrollToIndex(t))})}}),K(()=>e.items,(t,n)=>{a.value||V.value&&!n.length&&t.length&&(a.value=!0)}),Ce(()=>{const t=!!(e.chips||l.chip),n=!!(!e.hideNoData||S.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),c=o.value.length>0,w=U.filterProps(e),m=c||!V.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return s(U,x({ref:v},w,{modelValue:o.value.map(u=>u.props.value).join(", "),"onUpdate:modelValue":ue,focused:V.value,"onUpdate:focused":u=>V.value=u,validationValue:o.externalValue,counterValue:g.value,dirty:c,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":o.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:m,"onClick:clear":ee,"onMousedown:control":te,onBlur:ne,onKeydown:le,"aria-label":h(E.value),title:h(E.value)}),{...l,default:()=>s(O,null,[s(Ae,x({ref:D,modelValue:a.value,"onUpdate:modelValue":u=>a.value=u,activator:"parent",contentClass:"v-select__content",disabled:M.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ae},J.value),{default:()=>[n&&s(Ie,x({ref:T,selected:G.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:X,onFocusin:oe,onScrollPassive:Q,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var u,f,r;return[(u=l["prepend-item"])==null?void 0:u.call(l),!S.value.length&&!e.hideNoData&&(((f=l["no-data"])==null?void 0:f.call(l))??s(z,{title:h(e.noDataText)},null)),s(Re,{ref:A,renderless:!0,items:S.value},{default:p=>{var N;let{item:d,index:P,itemRef:k}=p;const q=x(d.props,{ref:k,key:P,onClick:()=>R(d,null)});return((N=l.item)==null?void 0:N.call(l,{item:d,index:P,props:q}))??s(z,x(q,{role:"option"}),{prepend:ie=>{let{isSelected:se}=ie;return s(O,null,[e.multiple&&!e.hideSelected?s(we,{key:d.value,modelValue:se,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependAvatar&&s(Fe,{image:d.props.prependAvatar},null),d.props.prependIcon&&s(W,{icon:d.props.prependIcon},null)])}})}}),(r=l["append-item"])==null?void 0:r.call(l)]}})]}),o.value.map((u,f)=>{function r(k){k.stopPropagation(),k.preventDefault(),R(u,!1)}const p={"onClick:close":r,onMousedown(k){k.preventDefault(),k.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},d=t?!!l.chip:!!l.selection,P=d?pe(t?l.chip({item:u,index:f,props:p}):l.selection({item:u,index:f})):void 0;if(!(d&&!P))return s("div",{key:u.value,class:"v-select__selection"},[t?l.chip?s(Pe,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>[P]}):s(ke,x({key:"chip",closable:e.closableChips,size:"small",text:u.title,disabled:u.props.disabled},p),null):P??s("span",{class:"v-select__selection-text"},[u.title,e.multiple&&f<o.value.length-1&&s("span",{class:"v-select__selection-comma"},[he(",")])])])})]),"append-inner":function(){var p;for(var u=arguments.length,f=new Array(u),r=0;r<u;r++)f[r]=arguments[r];return s(O,null,[(p=l["append-inner"])==null?void 0:p.call(l,...f),e.menuIcon?s(W,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),xe({isFocused:V,menu:a,select:R},v)}});export{Ne as V};
