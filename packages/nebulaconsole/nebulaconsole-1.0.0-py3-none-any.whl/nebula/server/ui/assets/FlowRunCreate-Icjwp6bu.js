import{ba as M,d as S,x as U,b3 as L,E as V,q as N,an as x,f as O,u as t,c as g,k as n,a as z,l as y,a1 as J,o as f,t as r,bb as Y,p as T,z as a,P as _,bc as H,F as k,bd as X,ac as q,be as D,ae as h,bf as C,b7 as E,b9 as G}from"./index-tQzbzZZu.js";import{u as $}from"./usePageTitle-LpUrSePH.js";class j extends M{parse(l){return JSON.parse(decodeURIComponent(l??""))}format(l){return encodeURIComponent(JSON.stringify(l))}}const K=_("span",null,"Enhanced deployment parameters UI improves support for lists, default values, validation, and more. Enable by updating your nebula config.",-1),Q=_("span",null,"To disable the enhanced deployment parameters UI by default update your nebula config.",-1),ee=S({__name:"FlowRunCreate",setup(P){const l=U(),A=L(),p=V("deploymentId"),d=J(),R=N("parameters",j,void 0),{deployment:c}=x(p),w=N("useEnhancedDeploymentParameters",q,!1),I=async u=>{var m,s;try{const e=await l.deployments.createDeploymentFlowRun(p.value,u),o=((s=(m=u.state)==null?void 0:m.stateDetails)==null?void 0:s.scheduledTime)??void 0,i=!o,b=C(D,{flowRun:e,flowRunRoute:h.flowRun,router:d,immediate:i,startTime:o});E(b,"success"),d.push(h.deployment(p.value))}catch(e){E("Something went wrong trying to create a flow run","error"),console.error(e)}},B=async u=>{var m,s;try{const e=await l.deployments.createDeploymentFlowRunV2(p.value,u),o=((s=(m=u.state)==null?void 0:m.stateDetails)==null?void 0:s.scheduledTime)??void 0,i=!o,b=C(D,{flowRun:e,flowRunRoute:h.flowRun,router:d,immediate:i,startTime:o});E(b,"success"),d.push(h.deployment(p.value))}catch(e){const o=G(e,"Something went wrong trying to create a flow run");E(o,"error"),console.error(e)}},v=()=>{d.back()},F=O(()=>c.value?`Create Flow Run for Deployment: ${c.value.name}`:"Create Flow Run for Deployment");return $(F),(u,m)=>{const s=y("p-link"),e=y("p-message"),o=y("p-code"),i=y("p-layout-default");return t(c)?(f(),g(i,{key:0},{header:n(()=>[r(t(Y),{deployment:t(c)},null,8,["deployment"])]),default:n(()=>[t(A).access.schemasV2&&!t(w)?(f(),T(k,{key:0},[r(e,{info:""},{default:n(()=>[a(" The enhanced deployment parameters UI improves support for lists, default values, validation, and more. "),_("strong",null,[a("If you're having trouble, please "),r(s,{href:"https://github.com/kozmoai/nebula/issues/new/choose"},{default:n(()=>[a("report an issue.")]),_:1})]),_("span",null,[a(" To revert to the previous deployment parameters UI click "),r(s,{href:"?useEnhancedDeploymentParameters=true",target:"_self"},{default:n(()=>[a("here")]),_:1}),a(".")])]),_:1}),r(t(H),{deployment:t(c),parameters:t(R),onSubmit:B,onCancel:v},null,8,["deployment","parameters"])],64)):(f(),T(k,{key:1},[t(w)?(f(),g(e,{key:1},{default:n(()=>[_("span",null,[a("To use the enhanced deployment parameters UI click "),r(s,{href:"?useEnhancedDeploymentParameters=false",target:"_self"},{default:n(()=>[a("here")]),_:1}),a(". ")]),Q,r(o,{class:"mt-2"},{default:n(()=>[a(" nebula config NEBULA_EXPERIMENTAL_ENABLE_ENHANCED_DEPLOYMENT_PARAMETERS=False ")]),_:1})]),_:1})):(f(),g(e,{key:0},{default:n(()=>[K,r(o,{class:"mt-2"},{default:n(()=>[a(" nebula config NEBULA_EXPERIMENTAL_ENABLE_ENHANCED_DEPLOYMENT_PARAMETERS=True ")]),_:1})]),_:1})),r(t(X),{deployment:t(c),parameters:t(R),onSubmit:I,onCancel:v},null,8,["deployment","parameters"])],64))]),_:1})):z("",!0)}}});export{ee as default};
