import{d as A,i as w,b as g,k as pe,c as m,o as S,e as x,f as o,t as E,m as G,_ as F,S as _e,r as D,U as $,H as j,V as B,Q,W as ve,I as me,w as X,v as Y,h as fe,F as ge,s as he,n as J,p as Z,j as ee,z as ye,u as q,l as Ce,q as be,R as Ie}from"./index-0d669be8.js";const Pe={class:"ChildlessPlaceholder"},$e={class:"content"},Ee={class:"title"},Se={key:0,class:"message"},Te=10,xe=A({__name:"ChildlessPlaceholder",props:{componentId:{}},setup(d){const n=w(g.core),_=d,{componentId:l}=pe(_),s=m(()=>n.getComponentById(l.value)),T=m(()=>n.getComponentDefinition(s.value.type)),r=(h,y)=>{const c=h.map(b=>n.getComponentDefinition(b)).map(b=>b==null?void 0:b.name);return`${c.slice(0,-1).join(", ")} ${c.length>1?y:""} ${c.at(-1)}`},I=m(()=>{const h=n.getContainableTypes(l.value);let y;return h.length<=Te&&(y=`You can add ${r(h,"and")} components`),y});return(h,y)=>(S(),x("div",Pe,[o("div",$e,[o("div",Ee,[o("h2",null,"Empty "+E(T.value.name),1)]),I.value?(S(),x("div",Se,E(I.value),1)):G("",!0)])]))}});const Me=F(xe,[["__scopeId","data-v-7f547886"]]),Be={class:"RenderError"},De={class:"title"},we={class:"message"},Ve=A({__name:"RenderError",props:{componentType:{},message:{}},setup(d){const n=d;return(_,l)=>(S(),x("div",Be,[o("div",De,[o("h2",null,"Error rendering "+E(n.componentType),1)]),o("div",we,E(n.message),1)]))}}),Re={props:["componentId","instancePath","instanceData"],setup(d){const n=w(g.core),_=w(g.builderManager),l=d.componentId,s=m(()=>n.getComponentById(l)),T=_e(s.value.type),r=d.instancePath,I=d.instanceData,{getEvaluatedFields:h,isComponentVisible:y}=Q(n),e=h(r),c=m(()=>n.getComponents(l,{sortedByPosition:!0})),i=m(()=>!!_&&_.getMode()!="preview"),b=m(()=>i.value&&!s.value.isCodeManaged&&s.value.type!=="root"),M=D(!1),V=m(()=>n.getUserFunctions()),se=()=>{if(!(c.value.length>0))return B(Me,{componentId:s.value.id})},L=(t,a=0)=>B(te,{componentId:t,key:`${t}:${a}`,instancePath:[...r,{componentId:t,instanceNumber:a}],instanceData:[...I,D(null)]}),K=(t=0,a=()=>!0,v=!1)=>{const u=f=>!i.value||v?[]:[B("div",{"data-streamsync-slot-of-id":l,"data-streamsync-position":f})],p=c.value.filter(a),C=p.filter(f=>!f.isCodeManaged).map(f=>L(f.id,t)),P=p.filter(f=>f.isCodeManaged).map(f=>L(f.id,t));return[...u(0),...C.map((f,R)=>[f,u(R+1)]).flat(),...P]},W=(t=>t.map(a=>`${a.componentId}:${a.instanceNumber}`).join(","))(r);$(g.evaluatedFields,e),$(g.componentId,l),$(g.isBeingEdited,i),$(g.isDisabled,M),$(g.instancePath,r),$(g.instanceData,I),$(g.renderProxiedComponent,L),$(g.getChildrenVNodes,K),$(g.flattenedInstancePath,W);const ne={"data-streamsync-id":l,"data-streamsync-instance-path":W},N=D(!1);j(()=>(_==null?void 0:_.getSelectedId())==l,t=>{N.value=t}),j(()=>e,()=>{N.value=!1},{deep:!0});const z=m(()=>c.value.length==0),oe=m(()=>y(l,r)),ae=(t,a)=>{if(!t.startsWith("$")&&!a)return u=>{let p=!1;V.value.some(C=>C.name==t&&C.args.includes("payload"))&&(p=!0),n.forwardEvent(u,r,p)};if(t.startsWith("$goToPage_")){const u=t.substring(10);return p=>n.setActivePageFromKey(u)}return null},le=m(()=>{const t={},a=Object.keys(s.value.handlers??{}),v=s.value.binding?[s.value.binding.eventType]:[];return Array.from(new Set([...a,...v])).forEach(p=>{var f;const C=`on${p.charAt(0).toUpperCase()}${p.slice(1)}`,P=p===((f=s.value.binding)==null?void 0:f.eventType);t[C]=R=>{var O,U;P&&n.forwardEvent(R,r,!0);const H=(O=s.value.handlers)==null?void 0:O[p];H&&((U=ae(H,P))==null||U(R))}}),t}),ce=m(()=>{var v;const t=(v=n.getComponentDefinition(s.value.type))==null?void 0:v.fields;if(!t)return;const a={};return Object.keys(t).forEach(u=>{t[u].applyStyleVariable&&e[u]&&(a[`--${u}`]=e[u].value)}),a}),re=m(()=>{var C;const t="cssClasses",a=(C=n.getComponentDefinition(s.value.type))==null?void 0:C.fields;if(!a||!a[t]||!e[t])return;const v=e[t].value,u=v==null?void 0:v.split(" ").map(P=>P.trim()),p={};return u.forEach(P=>{p[P]=!0}),p}),ie=function(){return{class:{[`ss-type-${s.value.type}`]:!0,component:!0,childless:z.value,selected:N.value,disabled:M.value,beingEdited:i.value,...re.value},style:{...ce.value,...oe.value?{}:{display:"none"}},...ne,...M.value?[]:le.value,draggable:b.value}},de=()=>(s.value.parentId?n.getContainableTypes(s.value.parentId):["root"]).includes(s.value.type),ue=(t,a)=>i.value?B(Ve,{...t,componentType:s.value.type,message:a}):B("div");return()=>{const t=i.value?se():void 0,a=({instanceNumber:u=0,componentFilter:p=()=>!0,positionlessSlot:C=!1})=>z.value?C?void 0:t:K(u,p,C),v={...ie()};return de()?B(T,v,{default:a}):ue(v,"Parent is not suitable for this component")}}};const te=F(Re,[["__scopeId","data-v-a731db34"]]),k=d=>(Z("data-v-54d2c60b"),d=d(),ee(),d),Ae=k(()=>o("i",{class:"ri-notification-2-line ri-xl"},null,-1)),Fe={class:"counter"},ke=k(()=>o("div",{class:"balloonFlash"},null,-1)),Le={class:"main"},Ne=k(()=>o("i",{class:"ri-close-line"},null,-1)),je=k(()=>o("i",{class:"ri-error-warning-fill ri-xl"},null,-1)),Ke=[je],We={class:"content"},ze={class:"title"},He={class:"time"},Oe={class:"message"},Ue=100,Xe=A({__name:"RendererNotifications",setup(d){const n=w(g.core),_=D(!1),l=D(null),s=ve([]),T=h=>{const{type:y,title:e,message:c,code:i}=h;s.unshift({type:y,title:e,message:c,code:i,timestampReceived:new Date}),s.splice(Ue),l.value.classList.remove("alert"),l.value.offsetWidth,l.value.classList.add("alert")};me(()=>{n.addMailSubscription("notification",T)});const r=()=>{s.length!=0&&(_.value=!_.value)},I=()=>{s.splice(0),_.value=!1};return(h,y)=>X((S(),x("div",{class:"RendererNotifications",onClick:r},[o("div",{ref_key:"balloon",ref:l,class:"balloon",title:"Toggle notifications"},[Ae,o("div",Fe,E(s.length),1)],512),ke,X(o("div",Le,[o("div",{class:"clearContainer"},[o("button",{onClick:I},[Ne,fe(" Clear all ")])]),(S(!0),x(ge,null,he(s,(e,c)=>(S(),x("div",{key:c,class:"notification"},[o("div",{class:J(["icon",e.type])},Ke,2),o("div",We,[o("header",null,[o("strong",ze,E(e.title),1),o("span",He,E(e.timestampReceived.toLocaleTimeString()),1)]),o("div",Oe,E(e.message),1)])]))),128))],512),[[Y,_.value]])],512)),[[Y,s.length>0]])}});const Ye=F(Xe,[["__scopeId","data-v-54d2c60b"]]),qe=d=>(Z("data-v-7f4207e0"),d=d(),ee(),d),Ge=qe(()=>o("div",{class:"loadingBar"},null,-1)),Qe={class:"rootComponentArea"},Je=A({__name:"ComponentRenderer",setup(d){const n=w(g.core),_=Q(n),l=n.getComponentById("root");l||console.error("No root component found.");const s=[{componentId:"root",instanceNumber:0}],T=[D(null)],r=_.getEvaluatedFields(s),I=m(()=>{var e,c,i,b,M,V;return{"--accentColor":(e=r.accentColor)==null?void 0:e.value,"--emptinessColor":(c=r.emptinessColor)==null?void 0:c.value,"--containerBackgroundColor":(i=r.parentIdBackgroundColor)==null?void 0:i.value,"--primaryTextColor":(b=r.primaryTextColor)==null?void 0:b.value,"--secondaryTextColor":(M=r.secondaryTextColor)==null?void 0:M.value,"--separatorColor":(V=r.separatorColor)==null?void 0:V.value}}),h=m(()=>n.getFrontendMessageMap().size>0);j(()=>{var e;return(e=r.appName)==null?void 0:e.value},e=>{y(e)},{immediate:!0});function y(e){const c=n.getMode();let i;e&&c=="edit"?i=`${e} | Streamsync Builder`:!e&&c=="edit"?i="Streamsync Builder":e&&c=="run"?i=`${e}`:!e&&c=="run"&&(i="Streamsync App"),document.title=i}return(e,c)=>(S(),x("main",{class:J(["ComponentRenderer",{loadingActive:h.value}]),tabindex:"-1",style:Ie(I.value)},[ye(Ye,{class:"notifications"}),Ge,o("div",Qe,[q(l)?(S(),Ce(te,{key:0,"component-id":q(l).id,"instance-path":s,"instance-data":T},null,8,["component-id"])):G("",!0),be(e.$slots,"default",{},void 0,!0)])],6))}});const tt=F(Je,[["__scopeId","data-v-7f4207e0"]]);export{tt as default};
