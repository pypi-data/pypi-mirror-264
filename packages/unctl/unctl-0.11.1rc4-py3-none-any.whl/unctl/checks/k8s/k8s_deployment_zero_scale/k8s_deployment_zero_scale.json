{
    "Enabled": true,
    "Provider": "k8s",
    "CheckID": "K8S802",
    "CheckTitle": "Zero Scale Deployment Check",
    "CheckType": ["Infrastructure"],
    "ServiceName": "deployment",
    "SubServiceName": "deployment",
    "ResourceIdTemplate": "TBD",
    "Severity": "High",
    "ResourceType": "Deployment",
    "Description": "Verify that Deployments have a non-zero replica count, preventing unintentional scaling down to zero",
    "Risk": "High",
    "RelatedUrl": "",
    "Remediation": {
        "Code": {
            "CLI": "",
            "NativeIaC": "",
            "Other": "",
            "Terraform": ""
        },
        "Recommendation": {
            "Text": "Please ensure all deployments have at least one replica to maintain service availability",
            "Url": ""
        }
    },
    "Categories": ["Availability"],
    "DependsOn": [],
    "RelatedTo": [],
    "Notes": "",
    "Cli": [
        "kubectl", "get", "deployment", "{{resource_name}}", 
        "-n", "{{resource_namespace}}", 
        "-o=jsonpath={.spec.replicas}"
    ],    
    "PositiveMatch": "{{resource_name}} has non-zero replicas",
    "NegativeMatch": "{{resource_name}} is scaled to zero",
    "DiagnosticClis": [
        "kubectl describe deployment {{resource_name}} -n {{resource_namespace}}"
    ]
}