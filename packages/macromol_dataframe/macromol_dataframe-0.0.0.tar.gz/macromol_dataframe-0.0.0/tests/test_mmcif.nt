test_extract_dataframe:
  -
    id: empty
    mmcif:
      > data_1abc
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([], {'a': str, 'b': str})
  -
    id: pair
    mmcif:
      > data_1abc
      > _mock_loop.a 1
      > _mock_loop.b 2
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2'),
      > ])
  -
    id: loop
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2'),
      >     dict(a='3', b='4'),
      > ])
  -
    id: required
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
      c: Column('c', required=True)
    error:
      type: mmdf.MmcifError
      message:
        - missing required column(s)
        - category: _mock_loop.*
        - missing column(s): ['c']
  -
    id: optional
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
      c: Column('c')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2', c=None),
      >     dict(a='3', b='4', c=None),
      > ], {'a': str, 'b': str, 'c': str})
  -
    id: cast
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      a: Column('a', dtype=int)
      b: Column('b', dtype=float)
    expected:
      > pl.DataFrame([
      >     dict(a=1, b=2.0),
      >     dict(a=3, b=4.0),
      > ])
  -
    id: cast-missing
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 .
      > 4 ?
    prefix: mock_loop
    schema:
      a: Column('a', dtype=int)
      b: Column('b', dtype=float)
    expected:
      > pl.DataFrame([
      >     dict(a=1, b=2.0),
      >     dict(a=3, b=None),
      >     dict(a=4, b=None),
      > ])
  -
    id: drop-missing
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > . .
      > ? ?
      > . ?
      > ? .
    prefix: mock_loop
    schema:
      a: Column('a')
      b: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(a='1', b='2'),
      > ])
  -
    id: alias
    mmcif:
      > data_1abc
      > loop_
      > _mock_loop.a
      > _mock_loop.b
      > 1 2
      > 3 4
    prefix: mock_loop
    schema:
      alpha: Column('a')
      beta: Column('b')
    expected:
      > pl.DataFrame([
      >     dict(alpha='1', beta='2'),
      >     dict(alpha='3', beta='4'),
      > ])

test_read_mmcif:
  -
    id: baseline
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,AAA,A,,1,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > 0,AAA,A,,1,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > 0,AAA,A,,1,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > 0,AAA,A,,1,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
  -
    id: parse-model-6dze
    mmcif:
      > data_6DZE
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1    N N    . GLY A 1 1  ? 7.443   2.693  -0.227  1.00 0.00 ? 1  GLY A N    1  
      > ATOM   2    C CA   . GLY A 1 1  ? 7.583   3.413  1.035   1.00 0.00 ? 1  GLY A CA   1  
      > ATOM   3    C C    . GLY A 1 1  ? 7.765   2.443  2.197   1.00 0.00 ? 1  GLY A C    1  
      > ATOM   4    O O    . GLY A 1 1  ? 8.884   2.044  2.516   1.00 0.00 ? 1  GLY A O    1  
      > ATOM   294  N N    . GLY A 1 1  ? 5.942   3.401  2.220   1.00 0.00 ? 1  GLY A N    2  
      > ATOM   295  C CA   . GLY A 1 1  ? 6.203   3.065  3.615   1.00 0.00 ? 1  GLY A CA   2  
      > ATOM   296  C C    . GLY A 1 1  ? 5.823   1.618  3.907   1.00 0.00 ? 1  GLY A C    2  
      > ATOM   297  O O    . GLY A 1 1  ? 4.682   1.209  3.689   1.00 0.00 ? 1  GLY A O    2  
      > ATOM   587  N N    . GLY A 1 1  ? 7.919   2.798  0.980   1.00 0.00 ? 1  GLY A N    3  
      > ATOM   588  C CA   . GLY A 1 1  ? 9.331   2.705  1.337   1.00 0.00 ? 1  GLY A CA   3  
      > ATOM   589  C C    . GLY A 1 1  ? 9.724   1.260  1.625   1.00 0.00 ? 1  GLY A C    3  
      > ATOM   590  O O    . GLY A 1 1  ? 9.929   0.468  0.705   1.00 0.00 ? 1  GLY A O    3  
    model_id: 2
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,,1,GLY,N, N,5.942,3.401,2.220,1.00,0.00 
      > 0,A,A,,1,GLY,CA,C,6.203,3.065,3.615,1.00,0.00 
      > 0,A,A,,1,GLY,C, C,5.823,1.618,3.907,1.00,0.00 
      > 0,A,A,,1,GLY,O, O,4.682,1.209,3.689,1.00,0.00 
  -
    id: parse-alt-loc-1fav
    mmcif:
      > data_1FAV
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > BBB B A 1 3PA C1A C 8.927  8.112  76.619  0.50 60.83
      > BBB B B 1 3PA C1A C 12.166 8.592  73.991  0.50 62.56
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,BBB,B,A,1,3PA,C1A,C, 8.927,8.112,76.619,0.50,60.83
      > 0,BBB,B,B,1,3PA,C1A,C,12.166,8.592,73.991,0.50,62.56
  -
    id: parse-missing-seq-id-5d8v
    mmcif:
      > data_5D8V
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   847  N  N    . CYS A 1 43 ? 19.548 21.174 2.193   1.00 2.42  ? 43  CYS A N    1 
      > ATOM   848  C  CA   . CYS A 1 43 ? 18.915 21.622 3.425   1.00 2.35  ? 43  CYS A CA   1 
      > ATOM   849  C  C    . CYS A 1 43 ? 17.568 22.304 3.171   1.00 2.41  ? 43  CYS A C    1 
      > ATOM   850  O  O    . CYS A 1 43 ? 16.649 22.179 3.981   1.00 2.70  ? 43  CYS A O    1 
      > ATOM   851  C  CB   . CYS A 1 43 ? 19.835 22.572 4.185   1.00 2.55  ? 43  CYS A CB   1 
      > ATOM   852  S  SG   . CYS A 1 43 ? 21.395 21.804 4.744   1.00 2.51  ? 43  CYS A SG   1 
      > HETATM 1669 FE FE1  . SF4 B 2 .  ? 20.757 20.303 6.303   1.00 2.32  ? 84  SF4 A FE1  1 
      > HETATM 1670 FE FE2  . SF4 B 2 .  ? 18.705 18.673 7.122   1.00 2.31  ? 84  SF4 A FE2  1 
      > HETATM 1671 FE FE3  . SF4 B 2 .  ? 20.166 20.036 8.941   1.00 2.40  ? 84  SF4 A FE3  1 
      > HETATM 1672 FE FE4  . SF4 B 2 .  ? 21.284 17.975 7.559   1.00 2.33  ? 84  SF4 A FE4  1 
      > HETATM 1673 S  S1   . SF4 B 2 .  ? 19.506 17.818 9.005   1.00 2.53  ? 84  SF4 A S1   1 
      > HETATM 1674 S  S2   . SF4 B 2 .  ? 22.247 20.032 7.934   1.00 2.47  ? 84  SF4 A S2   1 
      > HETATM 1675 S  S3   . SF4 B 2 .  ? 20.291 18.166 5.527   1.00 2.40  ? 84  SF4 A S3   1 
      > HETATM 1676 S  S4   . SF4 B 2 .  ? 18.833 20.972 7.390   1.00 2.46  ? 84  SF4 A S4   1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,,43,CYS,N,N,19.548,21.174,2.193,1.00,2.42
      > 0,A,A,,43,CYS,CA,C,18.915,21.622,3.425,1.00,2.35
      > 0,A,A,,43,CYS,C,C,17.568,22.304,3.171,1.00,2.41
      > 0,A,A,,43,CYS,O,O,16.649,22.179,3.981,1.00,2.70
      > 0,A,A,,43,CYS,CB,C,19.835,22.572,4.185,1.00,2.55
      > 0,A,A,,43,CYS,SG,S,21.395,21.804,4.744,1.00,2.51
      > 0,A,B,,,SF4,FE1,FE,20.757,20.303,6.303,1.00,2.32
      > 0,A,B,,,SF4,FE2,FE,18.705,18.673,7.122,1.00,2.31
      > 0,A,B,,,SF4,FE3,FE,20.166,20.036,8.941,1.00,2.40
      > 0,A,B,,,SF4,FE4,FE,21.284,17.975,7.559,1.00,2.33
      > 0,A,B,,,SF4,S1,S,19.506,17.818,9.005,1.00,2.53
      > 0,A,B,,,SF4,S2,S,22.247,20.032,7.934,1.00,2.47
      > 0,A,B,,,SF4,S3,S,20.291,18.166,5.527,1.00,2.40
      > 0,A,B,,,SF4,S4,S,18.833,20.972,7.390,1.00,2.46
  -
    id: parse-dna-atom-ids-1bna
    mmcif:
      > data_1BNA
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   1   O "O5'" . DC  A 1 1  ? 18.935 34.195 25.617  1.00 64.35 ? 1   DC  A "O5'" 1 
      > ATOM   2   C "C5'" . DC  A 1 1  ? 19.130 33.921 24.219  1.00 44.69 ? 1   DC  A "C5'" 1 
      > ATOM   3   C "C4'" . DC  A 1 1  ? 19.961 32.668 24.100  1.00 31.28 ? 1   DC  A "C4'" 1 
      > ATOM   4   O "O4'" . DC  A 1 1  ? 19.360 31.583 24.852  1.00 37.45 ? 1   DC  A "O4'" 1 
      > ATOM   5   C "C3'" . DC  A 1 1  ? 20.172 32.122 22.694  1.00 46.72 ? 1   DC  A "C3'" 1 
      > ATOM   6   O "O3'" . DC  A 1 1  ? 21.350 31.325 22.681  1.00 48.89 ? 1   DC  A "O3'" 1 
      > ATOM   7   C "C2'" . DC  A 1 1  ? 18.948 31.223 22.647  1.00 30.88 ? 1   DC  A "C2'" 1 
      > ATOM   8   C "C1'" . DC  A 1 1  ? 19.231 30.482 23.944  1.00 36.58 ? 1   DC  A "C1'" 1 
      > ATOM   9   N N1    . DC  A 1 1  ? 18.070 29.661 24.380  1.00 40.51 ? 1   DC  A N1    1 
      > ATOM   10  C C2    . DC  A 1 1  ? 18.224 28.454 25.015  1.00 16.62 ? 1   DC  A C2    1 
      > ATOM   11  O O2    . DC  A 1 1  ? 19.360 28.014 25.214  1.00 27.75 ? 1   DC  A O2    1 
      > ATOM   12  N N3    . DC  A 1 1  ? 17.143 27.761 25.377  1.00 20.55 ? 1   DC  A N3    1 
      > ATOM   13  C C4    . DC  A 1 1  ? 15.917 28.226 25.120  1.00 34.72 ? 1   DC  A C4    1 
      > ATOM   14  N N4    . DC  A 1 1  ? 14.828 27.477 25.444  1.00 40.31 ? 1   DC  A N4    1 
      > ATOM   15  C C5    . DC  A 1 1  ? 15.719 29.442 24.471  1.00 30.78 ? 1   DC  A C5    1 
      > ATOM   16  C C6    . DC  A 1 1  ? 16.843 30.171 24.101  1.00 25.90 ? 1   DC  A C6    1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,,1,DC,O5',O,18.935,34.195,25.617,1.00,64.35
      > 0,A,A,,1,DC,C5',C,19.130,33.921,24.219,1.00,44.69
      > 0,A,A,,1,DC,C4',C,19.961,32.668,24.100,1.00,31.28
      > 0,A,A,,1,DC,O4',O,19.360,31.583,24.852,1.00,37.45
      > 0,A,A,,1,DC,C3',C,20.172,32.122,22.694,1.00,46.72
      > 0,A,A,,1,DC,O3',O,21.350,31.325,22.681,1.00,48.89
      > 0,A,A,,1,DC,C2',C,18.948,31.223,22.647,1.00,30.88
      > 0,A,A,,1,DC,C1',C,19.231,30.482,23.944,1.00,36.58
      > 0,A,A,,1,DC,N1, N,18.070,29.661,24.380,1.00,40.51
      > 0,A,A,,1,DC,C2, C,18.224,28.454,25.015,1.00,16.62
      > 0,A,A,,1,DC,O2, O,19.360,28.014,25.214,1.00,27.75
      > 0,A,A,,1,DC,N3, N,17.143,27.761,25.377,1.00,20.55
      > 0,A,A,,1,DC,C4, C,15.917,28.226,25.120,1.00,34.72
      > 0,A,A,,1,DC,N4, N,14.828,27.477,25.444,1.00,40.31
      > 0,A,A,,1,DC,C5, C,15.719,29.442,24.471,1.00,30.78
      > 0,A,A,,1,DC,C6, C,16.843,30.171,24.101,1.00,25.90
  -
    id: assembly-identity
    mmcif:
      > data_9XYZ
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1
      > _pdbx_struct_assembly_gen.asym_id_list      A
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation' 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,AAA,A,,1,GLY,N, N,-1.195, 0.201,-0.206,1.00,0.00
      > 0,AAA,A,,1,GLY,CA,C, 0.230, 0.318,-0.502,1.00,0.00
      > 0,AAA,A,,1,GLY,C, C, 1.059,-0.390, 0.542,1.00,0.00
      > 0,AAA,A,,1,GLY,O, O, 0.545,-0.975, 1.499,1.00,0.00
  -
    id: assembly-exclude-subchain-2hwy
    mmcif:
      > data_2HWY
      > # 
      > loop_
      > _pdbx_struct_assembly_gen.assembly_id 
      > _pdbx_struct_assembly_gen.oper_expression 
      > _pdbx_struct_assembly_gen.asym_id_list 
      > 1 1 A 
      > 2 1 B 
      > # 
      > _pdbx_struct_oper_list.id                   1 
      > _pdbx_struct_oper_list.type                 'identity operation' 
      > _pdbx_struct_oper_list.name                 1_555 
      > _pdbx_struct_oper_list.symmetry_operation   x,y,z 
      > _pdbx_struct_oper_list.matrix[1][1]         1.0000000000 
      > _pdbx_struct_oper_list.matrix[1][2]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[1][3]         0.0000000000 
      > _pdbx_struct_oper_list.vector[1]            0.0000000000 
      > _pdbx_struct_oper_list.matrix[2][1]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[2][2]         1.0000000000 
      > _pdbx_struct_oper_list.matrix[2][3]         0.0000000000 
      > _pdbx_struct_oper_list.vector[2]            0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][1]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][2]         0.0000000000 
      > _pdbx_struct_oper_list.matrix[3][3]         1.0000000000 
      > _pdbx_struct_oper_list.vector[3]            0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM 1    N N   . PRO A 1 3   ? -7.120  12.992 30.105 1.00 22.59 ? 855  PRO A N   1 
      > ATOM 2    C CA  . PRO A 1 3   ? -6.938  12.689 28.680 1.00 22.52 ? 855  PRO A CA  1 
      > ATOM 3    C C   . PRO A 1 3   ? -5.550  12.160 28.374 1.00 22.25 ? 855  PRO A C   1 
      > ATOM 4    O O   . PRO A 1 3   ? -4.577  12.637 28.948 1.00 21.65 ? 855  PRO A O   1 
      > ATOM 5    C CB  . PRO A 1 3   ? -7.164  14.052 27.986 1.00 22.81 ? 855  PRO A CB  1 
      > ATOM 6    C CG  . PRO A 1 3   ? -6.899  15.087 29.029 1.00 22.19 ? 855  PRO A CG  1 
      > ATOM 7    C CD  . PRO A 1 3   ? -7.281  14.444 30.351 1.00 22.97 ? 855  PRO A CD  1 
      > ATOM 922  N N   . PRO B 1 3   ? 36.367  20.784 11.706 1.00 29.02 ? 855  PRO B N   1 
      > ATOM 923  C CA  . PRO B 1 3   ? 36.240  22.206 11.403 1.00 28.91 ? 855  PRO B CA  1 
      > ATOM 924  C C   . PRO B 1 3   ? 35.314  22.952 12.394 1.00 28.90 ? 855  PRO B C   1 
      > ATOM 925  O O   . PRO B 1 3   ? 35.052  22.440 13.501 1.00 29.18 ? 855  PRO B O   1 
      > ATOM 926  C CB  . PRO B 1 3   ? 35.676  22.207 9.963  1.00 29.03 ? 855  PRO B CB  1 
      > ATOM 927  C CG  . PRO B 1 3   ? 35.376  20.735 9.606  1.00 28.79 ? 855  PRO B CG  1 
      > ATOM 928  C CD  . PRO B 1 3   ? 35.452  19.972 10.888 1.00 29.19 ? 855  PRO B CD  1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,,3,PRO,N, N,-7.120,12.992,30.105,1.00,22.59
      > 0,A,A,,3,PRO,CA,C,-6.938,12.689,28.680,1.00,22.52
      > 0,A,A,,3,PRO,C, C,-5.550,12.160,28.374,1.00,22.25
      > 0,A,A,,3,PRO,O, O,-4.577,12.637,28.948,1.00,21.65
      > 0,A,A,,3,PRO,CB,C,-7.164,14.052,27.986,1.00,22.81
      > 0,A,A,,3,PRO,CG,C,-6.899,15.087,29.029,1.00,22.19
      > 0,A,A,,3,PRO,CD,C,-7.281,14.444,30.351,1.00,22.97
  -
    id: assembly-2-fold-symmetry-4dza
    mmcif:
      > data_4DZA
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1,2 
      > _pdbx_struct_assembly_gen.asym_id_list      A
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation'         1_555 x,y,z   1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000  0.0000000000 
      > 2 'crystal symmetry operation' 4_555 x,-y,-z 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000 -1.0000000000 
      > 0.0000000000 0.0000000000 0.0000000000 0.0000000000 -1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   2821 N N     . ALA A 1 399 ? -17.343 -4.234  -0.815  1.00 16.39 ? 399 ALA A N     1 
      > ATOM   2822 C CA    . ALA A 1 399 ? -17.982 -2.923  -0.508  1.00 19.33 ? 399 ALA A CA    1 
      > ATOM   2823 C C     . ALA A 1 399 ? -18.227 -2.015  -1.713  1.00 19.35 ? 399 ALA A C     1 
      > ATOM   2824 O O     . ALA A 1 399 ? -19.051 -1.064  -1.630  1.00 17.35 ? 399 ALA A O     1 
      > ATOM   2825 C CB    . ALA A 1 399 ? -17.157 -2.198  0.554   1.00 19.91 ? 399 ALA A CB    1 
    model_id: 1
    assembly_id: 1
    expected:
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,,399,ALA,N,N,-17.343,-4.234,-0.815,1.00,16.39
      > 0,A,A,,399,ALA,CA,C,-17.982,-2.923,-0.508,1.00,19.33
      > 0,A,A,,399,ALA,C,C,-18.227,-2.015,-1.713,1.00,19.35
      > 0,A,A,,399,ALA,O,O,-19.051,-1.064,-1.630,1.00,17.35
      > 0,A,A,,399,ALA,CB,C,-17.157,-2.198, 0.554,1.00,19.91
      > 1,A,A,,399,ALA,N,N,-17.343,4.234,0.815,1.00,16.39
      > 1,A,A,,399,ALA,CA,C,-17.982,2.923,0.508,1.00,19.33
      > 1,A,A,,399,ALA,C,C,-18.227,2.015,1.713,1.00,19.35
      > 1,A,A,,399,ALA,O,O,-19.051,1.064,1.630,1.00,17.35
      > 1,A,A,,399,ALA,CB,C,-17.157,2.198,-0.554,1.00,19.91
  -
    id: assembly-3-fold-symmetry-1fav
    mmcif:
      > data_1FAV
      > # 
      > _pdbx_struct_assembly_gen.assembly_id       1 
      > _pdbx_struct_assembly_gen.oper_expression   1,2,3 
      > _pdbx_struct_assembly_gen.asym_id_list      A,B 
      > # 
      > loop_
      > _pdbx_struct_oper_list.id 
      > _pdbx_struct_oper_list.type 
      > _pdbx_struct_oper_list.name 
      > _pdbx_struct_oper_list.symmetry_operation 
      > _pdbx_struct_oper_list.matrix[1][1] 
      > _pdbx_struct_oper_list.matrix[1][2] 
      > _pdbx_struct_oper_list.matrix[1][3] 
      > _pdbx_struct_oper_list.vector[1] 
      > _pdbx_struct_oper_list.matrix[2][1] 
      > _pdbx_struct_oper_list.matrix[2][2] 
      > _pdbx_struct_oper_list.matrix[2][3] 
      > _pdbx_struct_oper_list.vector[2] 
      > _pdbx_struct_oper_list.matrix[3][1] 
      > _pdbx_struct_oper_list.matrix[3][2] 
      > _pdbx_struct_oper_list.matrix[3][3] 
      > _pdbx_struct_oper_list.vector[3] 
      > 1 'identity operation'         1_555 x,y,z          1.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000  1.0000000000 0.0000000000 0.0000000000  0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > 2 'crystal symmetry operation' 2_655 -y+1,x-y,z    -0.5000000000 -0.8660254038  0.0000000000 35.8190000000  0.8660254038 -0.5000000000 0.0000000000 0.0000000000  0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > 3 'crystal symmetry operation' 3_665 -x+y+1,-x+1,z -0.5000000000  0.8660254038  0.0000000000 17.9095000000 -0.8660254038 -0.5000000000 0.0000000000 31.0201639382 0.0000000000 0.0000000000 1.0000000000 0.0000000000 
      > # 
      > loop_
      > _atom_site.group_PDB 
      > _atom_site.id 
      > _atom_site.type_symbol 
      > _atom_site.label_atom_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_entity_id 
      > _atom_site.label_seq_id 
      > _atom_site.pdbx_PDB_ins_code 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > _atom_site.pdbx_formal_charge 
      > _atom_site.auth_seq_id 
      > _atom_site.auth_comp_id 
      > _atom_site.auth_asym_id 
      > _atom_site.auth_atom_id 
      > _atom_site.pdbx_PDB_model_num 
      > ATOM   535 C CA  . ILE A 1 69 ? 15.451 7.295  87.150  1.00 21.29  ? 69  ILE A CA  1 
    model_id: 1
    assembly_id: 1
    expected:
      # Coordinates from PyMOL:
      # PyMOL> set assembly, 1
      # PyMOL> fetch 1fav
      # PyMOL> iterate_state 0, /1fav/A/A/69/CA, print(f'{x:.5f},{y:.5f},{z:.5f}')
      > symmetry_mate,chain_id,subchain_id,alt_id,seq_id,comp_id,atom_id,element,x,y,z,occupancy,b_factor
      > 0,A,A,,69,ILE,CA,C,15.45100, 7.29500,87.15000,1.0,21.29
      > 1,A,A,,69,ILE,CA,C,21.77584, 9.73346,87.15000,1.0,21.29
      > 2,A,A,,69,ILE,CA,C,16.50166,13.99171,87.15000,1.0,21.29
  -
    id: err-unknown-assembly
    mmcif:
      > data_9XYZ
      > # 
      > loop_
      > _atom_site.auth_asym_id 
      > _atom_site.label_asym_id 
      > _atom_site.label_alt_id 
      > _atom_site.label_seq_id 
      > _atom_site.label_comp_id 
      > _atom_site.label_atom_id 
      > _atom_site.type_symbol 
      > _atom_site.Cartn_x 
      > _atom_site.Cartn_y 
      > _atom_site.Cartn_z 
      > _atom_site.occupancy 
      > _atom_site.B_iso_or_equiv 
      > AAA A . 1 GLY N  N -1.195  0.201 -0.206 1.00 0.00
      > AAA A . 1 GLY CA C  0.230  0.318 -0.502 1.00 0.00
      > AAA A . 1 GLY C  C  1.059 -0.390  0.542 1.00 0.00
      > AAA A . 1 GLY O  O  0.545 -0.975  1.499 1.00 0.00
    model_id: 1
    assembly_id: 2
    error:
      type: mmdf.MmcifError
      message:
        - can't find biological assembly
        - known assemblies: ['1']
        - unknown assembly: '2'
