"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[3513],{5744:(e,a,o)=>{o.r(a),o.d(a,{default:()=>E});var r=o(641),t=o(3751);const s={class:"card"},n={class:"card-body"},l=(0,r.Lk)("h1",null,"New Kanban",-1),i=(0,r.Lk)("hr",null,null,-1),d={class:"row"},u=(0,r.Lk)("div",{class:"col-md-4"},[(0,r.Lk)("strong",null,"Please note"),(0,r.Lk)("p",{class:"text-instructions"},"Board names must be unique.")],-1),p={class:"col-md-8"},c={class:"form-group"},m={key:0,class:"error"},h={key:1,class:"error"},g=(0,r.Lk)("hr",null,null,-1),k={class:"row"},b=(0,r.Lk)("div",{class:"col-md-4"},[(0,r.Lk)("h2",null,"Columns & Levels"),(0,r.Lk)("p",{class:"text-instructions"}," Drag the cards around to sort out the columns how you want them. ")],-1),y={class:"col-md-4"},v={class:"col-md-4"},w=(0,r.Lk)("hr",null,null,-1),L=(0,r.Lk)("hr",null,null,-1),M={class:"row submit-row"},N={class:"col-md-12"};var f=o(5009),B=o(184),_=o(9639),A=o(3855),$=o(404),K=o(9827);const R={name:"NewKanban",setup:()=>({v$:(0,_.Ay)()}),components:{GroupPermissions:B.A,KanbanPropertyOrder:f.A,ValidationRendering:$.A},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},theme:{type:String,default:""},userGroupResults:{type:Array,default:()=>[]}},mixins:[K.A],data:()=>({checkingKanbanBoardName:!1,columnModel:[{id:0,property:"Normal",title:"Backlog"},{id:1,property:"Blocked",title:"Blocked"},{id:2,property:"Normal",title:"In Progress"},{id:4,property:"Normal",title:"Review and QA"},{id:5,property:"Closed",title:"Completed"}],groupModel:[],kanbanBoardNameModel:"",levelModel:[{id:0,title:"Sprint 1"},{id:1,title:"Sprint 2"}],searchTimeout:"",uniqueKanbanBoardName:!0}),validations:{columnModel:{required:A.mw},groupModel:{required:A.mw},kanbanBoardNameModel:{required:A.mw},levelModel:{required:A.mw}},watch:{kanbanBoardNameModel(){this.checkingKanbanBoardName=!0,""!==this.searchTimeout&&clearTimeout(this.searchTimeout),void 0===this.kanbanBoardNameModel?this.searchTimeout=setTimeout(this.checkKanbanBoardName,500):this.kanbanBoardNameModel.length>=3&&(this.searchTimeout=setTimeout(this.checkKanbanBoardName,500,this.kanbanBoardNameModel,null))}},methods:{addNewKanban(){if(this.v$.$touch(),this.v$.$invalid||!this.uniqueKanbanBoardName||this.checkingKanbanBoardName)return void this.$store.dispatch("newToast",{header:"Please check validation",message:"Sorry, but can you please fix all validation issues.",extra_classes:"bg-warning",delay:0});const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.columnModel.forEach((a=>{e.append("column_title",a.title),e.append("column_property",a.property)})),this.levelModel.forEach((a=>{e.append("level_title",a.title)})),this.groupModel.forEach((a=>{e.append("group_list",a)})),this.axios.post(`${this.rootUrl}new_kanban_save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.$store.dispatch("newToast",{header:"Issue Creating new Kanban board",message:`Issues creating new kanban board -> Error ${e}`,extra_classes:"bg-warning",delay:0})}))},checkKanbanBoardName(){const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.axios.post(`${this.rootUrl}kanban_information/check_kanban_board_name/`,e).then((e=>{this.uniqueKanbanBoardName=0===e.data.length,this.checkingKanbanBoardName=!1})).catch((e=>{this.$store.dispatch("newToast",{header:"Issue checking Kanban board name",message:`Issues checking kanban board name -> Error ${e}`,extra_classes:"bg-warning",delay:0})}))},updateGroupModel(e){this.groupModel=e},updatePropertyList(e){this[e.source]=e.data}}},E=(0,o(6262).A)(R,[["render",function(e,a,o,f,B,_){const A=(0,r.g2)("validation-rendering"),$=(0,r.g2)("kanban-property-order"),K=(0,r.g2)("group-permissions"),R=(0,r.g2)("n-config-provider");return(0,r.uX)(),(0,r.Wv)(R,{theme:e.getTheme(o.theme)},{default:(0,r.k6)((()=>[(0,r.Lk)("div",s,[(0,r.Lk)("div",n,[l,i,(0,r.Lk)("div",d,[(0,r.Q3)(" DESCRIPTION "),u,(0,r.Q3)(" BOARD NAME "),(0,r.Lk)("div",p,[(0,r.Lk)("div",c,[(0,r.Lk)("label",null,[(0,r.eW)("Kanban Board Name "),(0,r.bF)(A,{"error-list":f.v$.kanbanBoardNameModel.$errors},null,8,["error-list"]),B.uniqueKanbanBoardName?(0,r.Q3)("v-if",!0):((0,r.uX)(),(0,r.CE)("span",m," Please supply a unique name")),B.checkingKanbanBoardName?((0,r.uX)(),(0,r.CE)("span",h," Checking kanban name...")):(0,r.Q3)("v-if",!0)]),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>B.kanbanBoardNameModel=e)},null,512),[[t.vModelText,B.kanbanBoardNameModel]])])])]),g,(0,r.Q3)(" Properties for the drag and drop coloumns/levels "),(0,r.Lk)("div",k,[b,(0,r.Lk)("div",y,[(0,r.bF)($,{"property-name":"Column","property-list":B.columnModel,source:"columnModel","is-dirty":f.v$.columnModel.$dirty,onUpdate_property_list:a[1]||(a[1]=e=>_.updatePropertyList(e))},null,8,["property-list","is-dirty"])]),(0,r.Lk)("div",v,[(0,r.bF)($,{"property-name":"Level","property-list":B.levelModel,source:"levelModel","is-dirty":f.v$.columnModel.$dirty,onUpdate_property_list:a[2]||(a[2]=e=>_.updatePropertyList(e))},null,8,["property-list","is-dirty"])])]),(0,r.Q3)(" Group Permissions "),w,(0,r.bF)(K,{"group-results":o.groupResults,destination:"kanban_board","user-group-results":o.userGroupResults,onUpdate_group_model:a[3]||(a[3]=e=>_.updateGroupModel(e)),"is-dirty":f.v$.groupModel.$dirty},null,8,["group-results","user-group-results","is-dirty"]),(0,r.Q3)(" SAVE "),L,(0,r.Lk)("div",M,[(0,r.Lk)("div",N,[(0,r.Lk)("button",{class:"btn btn-primary save-changes",onClick:a[4]||(a[4]=(...e)=>_.addNewKanban&&_.addNewKanban(...e))}," Add Kanban ")])])])])])),_:1},8,["theme"])}]])},184:(e,a,o)=>{o.d(a,{A:()=>y});var r=o(641),t=o(33);const s={class:"row"},n={class:"col-md-4"},l=(0,r.Lk)("h2",null,"Group Permissions",-1),i={class:"text-instructions"},d=(0,r.Lk)("p",{class:"text-instructions"}," If you do not add one of your own group(s), you will only get readonly access. ",-1),u={class:"col-md-8"},p=(0,r.Lk)("br",null,null,-1),c={key:0,class:"alert alert-warning"};var m=o(1080),h=o(9639),g=o(3855),k=o(404);const b={name:"GroupPermissions",setup:()=>({v$:(0,h.Ay)()}),components:{NSelect:m.A,ValidationRendering:k.A},props:{destination:{type:String,default:""},displayGroupPermissionIssue:{type:Boolean,default:!1},groupResults:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!0},userGroupResults:{type:Array,default:()=>[]}},watch:{groupModel(){this.$emit("update_group_model",this.groupModel)}},data:()=>({groupFixResults:[],groupModel:[]}),validations:{groupModel:{required:g.mw}},mounted(){this.groupFixResults=this.groupResults.map((e=>({value:e.pk,label:e.fields.group_name}))),this.groupModel=this.userGroupResults.map((e=>e.group_id))}},y=(0,o(6262).A)(b,[["render",function(e,a,o,m,h,g){const k=(0,r.g2)("validation-rendering"),b=(0,r.g2)("n-select");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.Lk)("div",n,[l,(0,r.Lk)("p",i," Add or remove groups from this "+(0,t.toDisplayString)(o.destination)+". Adding a group will allow users from that group to access this "+(0,t.toDisplayString)(o.destination)+". ",1),d]),(0,r.Lk)("div",u,[(0,r.Lk)("label",null,[(0,r.eW)("Group List "),(0,r.bF)(k,{"error-list":m.v$.groupModel.$errors},null,8,["error-list"])]),(0,r.bF)(b,{options:h.groupFixResults,label:"group",value:h.groupModel,"onUpdate:value":a[0]||(a[0]=e=>h.groupModel=e),multiple:""},null,8,["options","value"]),(0,r.Q3)(" ALERT FOR WHEN USER GROUPS ARE NOT INCLUDED "),p,o.displayGroupPermissionIssue?((0,r.uX)(),(0,r.CE)("div",c," None of your user groups were included. You will not have permissions to create this object. Please select one of your groups ")):(0,r.Q3)("v-if",!0)])])}]])},404:(e,a,o)=>{o.d(a,{A:()=>n});var r=o(641),t=o(33);const s={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},n=(0,o(6262).A)(s,[["render",function(e,a,o,s,n,l){return(0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.errorList,(e=>((0,r.uX)(),(0,r.CE)("span",{class:"error",key:e.$uid},(0,t.toDisplayString)(e.$message),1)))),128)}]])}}]);